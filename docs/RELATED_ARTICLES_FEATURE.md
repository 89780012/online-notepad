# 相关文章功能文档

## 功能概述

为博客详情页添加了相关文章侧边栏，提升用户体验和SEO效果。该功能能够智能推荐与当前文章相关的其他文章，增加页面停留时间和内部链接强度。

## 主要特性

### 1. 智能推荐算法
- **基于关键词匹配**：优先推荐具有相同或相似关键词的文章
- **时间排序**：在关键词匹配的基础上，按发布时间排序
- **智能补全**：如果基于关键词的推荐不足，自动补充最新发布的文章
- **去重机制**：确保不重复推荐相同文章，排除当前正在阅读的文章

### 2. 响应式设计
- **桌面端**：与文章内容并列显示，右侧固定侧边栏（sticky定位）
- **移动端**：自动堆叠显示，确保不影响阅读体验
- **断点设置**：lg断点（1024px）作为切换点
- **布局优化**：英雄区域高度缩减，更多空间给内容区域

### 3. 用户体验优化
- **加载状态**：优雅的骨架屏加载效果
- **悬停动画**：渐变背景和微交互动画
- **渐进增强**：失败时静默处理，不影响主要内容
- **阅读时间估算**：基于内容长度估算阅读时间

### 4. SEO优化
- **结构化数据**：添加Schema.org ItemList结构化数据
- **内部链接**：增强站内链接结构
- **语义化HTML**：使用正确的HTML标签结构
- **关键词标签**：显示文章关键词标签

## 技术实现

### API接口
```
GET /api/blog/[slug]/related?limit=6
```

**响应格式：**
```json
{
  "related": [
    {
      "id": "string",
      "title": "string", 
      "description": "string",
      "slug": "string",
      "publishedAt": "string",
      "tags": ["string"]
    }
  ],
  "total": "number"
}
```

### 组件结构
- `RelatedArticles.tsx`：主要组件
- 支持自定义样式和类名
- 客户端渲染，支持异步加载

### 数据库查询策略
1. 获取当前文章的关键词
2. 基于关键词进行模糊匹配查询
3. 按发布时间降序排列
4. 如果结果不足，补充最新文章
5. 限制返回数量（默认6篇）

## 文件结构

```
src/
├── app/api/blog/[slug]/related/route.ts  # 相关文章API
├── components/RelatedArticles.tsx         # 相关文章组件
└── app/blog/[slug]/page.tsx              # 博客详情页（已更新）
```

## 配置选项

### RelatedArticles组件属性
- `currentSlug: string` - 当前文章的slug
- `className?: string` - 自定义CSS类名

### API查询参数
- `limit: number` - 返回文章数量限制（默认6）

## 性能考虑

1. **缓存策略**：API使用`cache: 'no-store'`确保数据新鲜度
2. **错误处理**：静默处理错误，不影响主要内容加载
3. **懒加载**：组件仅在需要时才发起API请求
4. **数据库优化**：使用索引优化关键词查询性能

## 最新更新（v2.0）

### 布局优化
- **并列显示**：相关文章现在与文章内容并列显示，而非独立的侧边栏
- **英雄区域缩减**：将英雄区域高度从 py-16 sm:py-24 缩减为 py-8 sm:py-12
- **响应式改进**：使用 lg 断点（1024px）替代 xl 断点（1280px），更早显示并列布局
- **视觉优化**：简化相关文章组件样式，更适合作为内容区域的一部分

### 布局结构
```
桌面端 (≥1024px):
┌─────────────────────────────────────────┐
│              英雄区域 (缩减)               │
├─────────────────────┬───────────────────┤
│    文章内容 (3/4)    │  相关文章 (1/4)   │
│                     │   (sticky)        │
└─────────────────────┴───────────────────┘

移动端 (<1024px):
┌─────────────────────────────────────────┐
│              英雄区域 (缩减)               │
├─────────────────────────────────────────┤
│              文章内容                    │
├─────────────────────────────────────────┤
│              相关文章                    │
└─────────────────────────────────────────┘
```

## 后续优化建议

1. **缓存机制**：添加Redis缓存提升查询性能
2. **A/B测试**：测试不同推荐算法的效果
3. **用户行为追踪**：记录点击率优化推荐算法
4. **个性化推荐**：基于用户阅读历史进行个性化推荐
5. **标签系统**：建立更完善的文章标签分类系统

## 兼容性

- 支持所有现代浏览器
- 移动端友好
- 渐进增强设计
- 无障碍访问支持
